---
import { Image } from 'astro:assets';
import { formatDateShort } from '../utils/date';

interface Props {
  title: string;
  description: string;
  date: Date;
  tags: string[];
  url: string;
  cover?: string | any;
  draft?: boolean;
  index: number;
}

const { title, description, date, tags, url, cover, draft = false, index } = Astro.props;

// Helper function to get terminal color class based on index
function getTerminalColor(idx: number): string {
  const colors = ['terminal-blue', 'terminal-green', 'cyber-cyan', 'cyber-purple'];
  return colors[idx % colors.length];
}

// Helper function to get icon for each blog post
function getPostIcon(idx: number): string {
  const icons = ['markdown', 'readme', 'git', 'vim', 'gnubash', 'linux'];
  return icons[idx % icons.length];
}

const colorClass = getTerminalColor(index);
---

<a
  href={url}
  class="blog-post-item block p-4 bg-[var(--bg-elevated)] border border-[var(--border-color)] rounded-lg hover:border-cyber-cyan transition-all hover-glow"
  data-tags={JSON.stringify(tags)}
>
  {cover && (
    <div class="mb-3 rounded-lg overflow-hidden border border-[var(--border-color)]">
      {typeof cover === 'string' ? (
        <img 
          src={cover} 
          alt={title}
          class="w-full h-40 object-cover"
        />
      ) : (
        <Image
          src={cover}
          alt={title}
          width={400}
          height={200}
          class="w-full h-40 object-cover"
        />
      )}
    </div>
  )}
  
  <div class="flex items-center gap-2 mb-2">
    <h2 class={`text-lg font-semibold text-${colorClass}`}>
      {title}
    </h2>
    {draft && (
      <span class="px-2 py-0.5 text-xs bg-terminal-yellow/20 text-terminal-yellow border border-terminal-yellow/50 rounded flex-shrink-0">
        draft
      </span>
    )}
  </div>

  {description && (
    <p class="text-sm text-[var(--text-secondary)] mb-3 line-clamp-2">
      {description}
    </p>
  )}

  <div class="flex items-center justify-between text-xs text-[var(--text-tertiary)] font-mono">
    <span>{formatDateShort(date)}</span>
    {tags.length > 0 && (
      <div class="flex gap-1 flex-wrap">
        {tags.slice(0, 2).map((tag: string) => (
          <span class="px-2 py-0.5 bg-[var(--bg-primary)] border border-[var(--border-color)] rounded">
            #{tag}
          </span>
        ))}
        {tags.length > 2 && (
          <span class="px-2 py-0.5">+{tags.length - 2}</span>
        )}
      </div>
    )}
  </div>
</a>
